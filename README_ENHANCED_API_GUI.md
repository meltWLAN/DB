# 增强API与GUI集成系统

本项目实现了股票分析系统的增强API可靠性模块与GUI界面的集成，提供了更稳定、高效的股票信息查询和分析功能。

## 功能特点

1. **增强API可靠性**
   - 支持API调用超时控制和自动重试机制
   - 本地硬编码股票数据库作为故障备份
   - 高效缓存机制减少重复API调用
   - 批量获取股票名称功能，减少API调用次数

2. **用户界面集成**
   - 股票名称和行业信息实时显示
   - API状态监控面板
   - 批量名称和行业数据测试工具
   - 缓存管理和统计功能

3. **性能优化**
   - 名称查询性能大幅提升（从30秒到0.01秒）
   - 批量处理减少API调用次数
   - 智能缓存减少重复查询

## 系统架构

整个系统由以下几个主要模块组成：

- `enhance_api_reliability.py`: 核心增强API可靠性模块
- `stock_analysis_gui.py`: 主GUI界面
- `gui_controller.py`: GUI控制器，负责界面与数据层的交互
- `enhanced_gui_controller.py`: 增强版GUI控制器
- `test_enhanced_api_gui.py`: 测试脚本
- `launch_enhanced_gui.py`: 启动脚本

## 安装指南

### 环境要求

- Python 3.7+
- 依赖库: pandas, numpy, tushare, tkinter, matplotlib

### 安装步骤

1. 克隆或下载项目代码
2. 安装依赖库：
   ```
   pip install -r requirements.txt
   ```
3. 确保Tushare API token已配置（如需使用Tushare数据）

## 使用方法

### 启动系统

```bash
python launch_enhanced_gui.py
```

启动后，系统会显示一个启动画面，然后加载主界面。

### GUI功能区介绍

1. **动量分析标签页**
   - 设置分析参数（样本大小、行业、最低得分）
   - 运行增强分析并查看结果

2. **均线交叉策略标签页**
   - 设置策略参数
   - 运行策略并查看结果

3. **组合策略标签页**
   - 结合动量和均线交叉策略的分析

4. **日志标签页**
   - 显示系统运行日志
   - API测试按钮：测试批量名称获取和行业数据获取
   - 缓存清理按钮：清除API缓存数据

5. **状态栏**
   - 左侧显示系统状态信息
   - 右侧显示API状态（调用成功率、缓存大小等）

### 测试增强API功能

可以通过日志标签页中的API测试按钮来测试增强API功能，或者直接运行：

```bash
python test_enhanced_api_gui.py
```

此测试脚本将验证增强API与GUI的集成情况，包括股票名称获取、行业数据获取等。

## 开发者说明

### 扩展增强API

如需扩展增强API的功能，主要修改`enhance_api_reliability.py`文件：

1. 添加新的API函数
2. 使用`with_retry`装饰器增强函数可靠性
3. 添加适当的缓存机制
4. 在相应的GUI控制器中调用新函数

### 修改GUI

如需修改GUI界面，主要涉及以下文件：

1. `stock_analysis_gui.py`: 主界面布局和组件
2. `gui_controller.py`/`enhanced_gui_controller.py`: 控制逻辑

## 常见问题

**Q: 为什么需要增强API可靠性？**

A: 在实际应用中，网络API调用可能因各种原因失败，如网络不稳定、服务器繁忙等。增强API可靠性模块通过添加重试机制、超时控制、本地缓存和备份数据等方式，大大提高了系统的稳定性和响应速度。

**Q: 如何查看API调用统计信息？**

A: 在GUI界面的状态栏右侧显示基本的API状态信息。更详细的信息可以在日志标签页中通过API测试功能查看。

**Q: 系统支持哪些数据源？**

A: 目前主要支持Tushare数据源，同时提供了本地数据库作为备份。可以通过修改配置来支持其他数据源。

## 更新日志

- v1.0.0 (2025-04-27): 首次发布，集成增强API可靠性模块与GUI界面

## 许可证

本项目采用MIT许可证。详见LICENSE文件。 